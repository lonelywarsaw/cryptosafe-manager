from src.core.config import get_config

_current_config = None

def set_config(config):
    global _current_config
    _current_config = config

STRINGS = {
    "ru": {
        "title_main": "Менеджер паролей CryptoSafe",
        "menu_file": "Файл",
        "menu_new": "Создать",
        "menu_open": "Открыть",
        "menu_backup": "Резервная копия",
        "menu_exit": "Выход",
        "menu_edit": "Правка",
        "menu_add": "Добавить",
        "menu_edit_entry": "Изменить",
        "menu_delete": "Удалить",
        "menu_view": "Вид",
        "menu_logs": "Журнал",
        "menu_settings": "Настройки",
        "menu_help": "Справка",
        "menu_about": "О программе",
        "status_locked": "Заблокировано | Буфер: --",
        "status_unlocked": "Разблокировано | Буфер: {}",
        "dlg_unlock_title": "Разблокировка",
        "label_master_pw": "Мастер-пароль:",
        "btn_unlock": "Разблокировать",
        "dlg_setup_title": "CryptoSafe Manager — Первоначальная настройка",
        "label_create_pw": "Создайте мастер-пароль",
        "label_confirm_pw": "Подтвердите мастер-пароль",
        "label_db_path": "Расположение базы данных",
        "btn_browse": "Обзор...",
        "btn_finish": "Готово",
        "btn_cancel": "Отмена",
        "dlg_settings_title": "Настройки",
        "tab_security": "Безопасность",
        "tab_appearance": "Внешний вид",
        "tab_advanced": "Дополнительно",
        "label_clipboard_timeout": "Очистка буфера (секунд):",
        "label_auto_lock": "Автоблокировка (минут):",
        "label_theme": "Тема:",
        "label_lang": "Язык:",
        "btn_ok": "ОК",
        "dlg_entry_add": "Добавить запись",
        "dlg_entry_edit": "Изменить запись",
        "label_title": "Название:",
        "label_username": "Имя пользователя:",
        "label_password": "Пароль:",
        "label_url": "URL:",
        "label_notes": "Заметки:",
        "btn_save": "Сохранить",
        "dlg_logs_title": "Журнал событий",
        "msg_backup_first": "Сначала откройте базу данных.",
        "msg_backup_saved": "Резервная копия сохранена.",
        "msg_unlock_first": "Сначала разблокируйте хранилище.",
        "msg_select_entry": "Выберите запись.",
        "msg_delete_confirm": "Удалить эту запись?",
        "msg_error_title": "Укажите название.",
        "msg_error_failed": "Операция не выполнена.",
        "msg_unlock_invalid": "Неверный пароль или данные.",
        "msg_unlock_no_salt": "Мастер-пароль не найден. Запустите первоначальную настройку.",
        "about_text": "Менеджер паролей CryptoSafe\nВерсия 1\nЗащищённое хранилище паролей.",
    },
    "en": {
        "title_main": "CryptoSafe Password Manager",
        "menu_file": "File",
        "menu_new": "New",
        "menu_open": "Open",
        "menu_backup": "Backup",
        "menu_exit": "Exit",
        "menu_edit": "Edit",
        "menu_add": "Add",
        "menu_edit_entry": "Edit",
        "menu_delete": "Delete",
        "menu_view": "View",
        "menu_logs": "Log",
        "menu_settings": "Settings",
        "menu_help": "Help",
        "menu_about": "About",
        "status_locked": "Locked | Buffer: --",
        "status_unlocked": "Unlocked | Buffer: {}",
        "dlg_unlock_title": "Unlock",
        "label_master_pw": "Master password:",
        "btn_unlock": "Unlock",
        "dlg_setup_title": "CryptoSafe Manager — Initial Setup",
        "label_create_pw": "Create master password",
        "label_confirm_pw": "Confirm master password",
        "label_db_path": "Database location",
        "btn_browse": "Browse...",
        "btn_finish": "Finish",
        "btn_cancel": "Cancel",
        "dlg_settings_title": "Settings",
        "tab_security": "Security",
        "tab_appearance": "Appearance",
        "tab_advanced": "Advanced",
        "label_clipboard_timeout": "Clipboard timeout (seconds):",
        "label_auto_lock": "Auto-lock (minutes):",
        "label_theme": "Theme:",
        "label_lang": "Language:",
        "btn_ok": "OK",
        "dlg_entry_add": "Add entry",
        "dlg_entry_edit": "Edit entry",
        "label_title": "Title:",
        "label_username": "Username:",
        "label_password": "Password:",
        "label_url": "URL:",
        "label_notes": "Notes:",
        "btn_save": "Save",
        "dlg_logs_title": "Event log",
        "msg_backup_first": "Open a database first.",
        "msg_backup_saved": "Backup saved.",
        "msg_unlock_first": "Unlock the vault first.",
        "msg_select_entry": "Select an entry.",
        "msg_delete_confirm": "Delete this entry?",
        "msg_error_title": "Enter a title.",
        "msg_error_failed": "Operation failed.",
        "msg_unlock_invalid": "Invalid password or data.",
        "msg_unlock_no_salt": "Master password not found. Run initial setup.",
        "about_text": "CryptoSafe Password Manager\nVersion 1\nSecure password vault.",
    },
}

def t(key):
    config = _current_config if _current_config is not None else get_config()
    lang = config.language
    return STRINGS.get(lang, STRINGS["ru"]).get(key, key)
